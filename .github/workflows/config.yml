

name: branch-protection
on:
  push:
    branches: [main]
jobs:
  enforce-branch-rules:
    runs-on: windows-latest
    strategy:
      matrix:
        node-version: [20]
    steps:
      - name: check-code-changes
        if: github.event_name == 'push'
        run: |
          if git diff-tree --no-commit-id --name-only -r "${{ github.sha }}" | grep -q ".*"; then
            echo "Code changes detected."
          else
            echo "No code changes detected."
            exit 78
          fi
      - name: enforce-rules
        if: ${{ github.event_name == 'push' && steps.check-code-changes.outcome == 'success' }}
        run: |
          if [[ "${{ steps.check-code-changes.outcome }}" == "success" ]]; then
            # add commands for enforcing rules here
            echo "Enforcing rules..."
          else
            echo "No code changes detected, skipping rules enforcement."
            exit 78
          fi
      - name: setup-job
        if: ${{ github.event_name == 'push' && steps.check-code-changes.outcome == 'success' }}
